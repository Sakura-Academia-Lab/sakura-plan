# 計算診断テスト 設計書

## 📋 目次

1. [全体構成](#全体構成)
2. [訓練ファイルの設計](#訓練ファイルの設計)
3. [テストファイルの設計](#テストファイルの設計)
4. [ファイル一覧](#ファイル一覧)
5. [問題作成の原則](#問題作成の原則)
6. [変更履歴](#変更履歴)

---

## 全体構成

### ステージ構成

- **第1部：反射神経** - 基本的な計算の暗記・自動化
- **第2部：構造視力** - 計算の構造を見抜く力
- **第3部：持久力** - 複雑な計算を最後まで遂行する力（未実装）

### レベル構成

各訓練単元は原則として5段階のレベルで構成（※単元Bは2段階）：

| レベル | 名称 | 問題数 | 時間目標 | 目的 |
|--------|------|--------|----------|------|
| Level 1 | 導入・単純反復 | 20問 | 1分 | 基本パターンの定着 |
| Level 2 | 定着・パターン網羅 | 20問 | 1分30秒 | 様々なパターンへの応用（小数を混ぜる等） |
| Level 3 | 壁・罠・瞬発力 | 15問 | 2分 | 難問・ひっかけ問題への対応 |
| Level 4 | 応用・実践投入 | 10問 | 2分 | 実践的な応用 |
| Level 5 | 達人・複合問題 | 10問 | 3分 | 最高難度の複合問題 |

**合計：75問 / 9分30秒**（※単元Bは40問 / 2分30秒）

> [!IMPORTANT]
> **小学生向け制限**: ルート ($\sqrt{}$) や累乗 ($x^n$) の記号は使用せず、掛け算形式 ($13 \times 13$) や言葉での説明で表現する。

### サバイバルテスト構成

- **問題数**: 35問（7単元 × 5レベル）
- **制限時間**: 3分
- **セット数**: 3セット（セットA, セットB, セットC）
- **採点方法**: 番号順に解き、連続正解数が得点
- **単元Bの扱い**: Level 3〜5の枠にも、Level 1または2から問題を抽出する。

---

## 訓練ファイルの設計

### ファイル命名規則

```
sec[ステージ番号][単元記号]_[英語名].js
```

例: `sec1a_decimal_fraction.js`

### データ構造

```javascript
addData({
  id: "sec1a",                    // ステージ番号+単元記号
  chapter: "第1部：反射神経",      // ステージ名
  section: "訓練",                 // 固定値
  title: "【単元A】小数↔分数変換", // 単元名
  method: "説明文...",             // 学習方法の説明
  patterns: [
    {
      label: "Level 1：導入・単純反復",  // レベル名（必須）
      timeGoal: "⏱️ タイム目標：1分以内",
      coaching: "💬 コーチングメッセージ",
      modelAnswer: "【お手本】具体例",
      problems: [...],              // 問題配列
      answers: [...],               // 解答配列
      annotations: [...]            // 解説配列
    },
    // Level 2-5...
  ]
});
```

### レベル設計原則

#### Level 1：導入・単純反復（20問）

- **目的**: 基本パターンを身体に染み込ませる
- **問題作成**:
  - 暗記項目：同じ問題を繰り返してOK（例: 0.5→1/2を10回）
  - 構造項目：同じ構造で数値を変える（例: 51, 57, 91の素因数分解）
- **時間**: 1分

#### Level 2：定着・パターン網羅（20問）

- **目的**: 様々なパターンを網羅
- **問題作成**: Level 1より広範囲・多様な問題
- **時間**: 1分30秒

#### Level 3：壁・罠・瞬発力（15問）

- **目的**: ひっかけ・難問への対応
- **問題作成**: 素数もどき、大きな数、複雑な構造
- **時間**: 2分

#### Level 4：応用・実践投入（10問）

- **目的**: 実践的な応用
- **問題作成**: 複数の技法の組み合わせ
- **時間**: 2分

#### Level 5：達人・複合問題（10問）

- **目的**: 最高難度の問題
- **問題作成**: 複雑な複合問題、Sランク向け
- **時間**: 3分

---

## 訓練単元のレベル詳細仕様

各単元の Level 1〜5 の具体的な構成案です。

### 第1部：反射神経

#### 【単元A】小数↔分数変換 (`sec1a`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 0.5=1/2, 0.25=1/4, 0.75=3/4 の相互変換のみ。 |
| **Level 2** | パターン網羅 | 1/8系列（0.125〜0.875）と1/5系列（0.2〜0.8）を追加。 |
| **Level 3** | 壁・瞬発力 | 1より大きい数（1.25, 1.5, 1.75など）と逆変換のシャッフル。 |
| **Level 4** | 応用・実践 | 簡単な足し算・引き算（0.5+1/4など）や掛け算（0.125×8）。 |
| **Level 5** | 達人・複合 | 逆算（□×0.25=0.5）や3項の複合計算、大小比較。 |

#### 【単元B】平方数：11〜19の段 (`sec1b`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 11×11 〜 19×19 の単純な計算。頻出の11, 12, 15などは多めに。 |
| **Level 2** | 小数の混在 | 1.1×1.1, 1.2×1.2, 0.15×15 など、平方数に小数を混ぜた計算。 |

#### 【単元C】円周率の段：3.14の暗算 (`sec1c`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 3.14 × 2〜9 の基本的な暗記。 |
| **Level 2** | パターン網羅 | 3.14 × 10, 20, 100 などの10の倍数や、11, 12 などの延長。 |
| **Level 3** | 壁・瞬発力 | 3.14 × 0.1, 0.5, 1.5 などの小数倍や、200, 500 などの大きな数。 |
| **Level 4** | 応用・実践 | 半径から面積・円周を求める実践形式（3.14×4, ×25など）。 |
| **Level 5** | 達人・複合 | 面積から半径を求める逆算や、分配法則の活用（3.14×8 - 3.14×3）。 |

#### 【単元D】素数判定・素因数分解 (`sec1d`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 51, 57, 91, 77 などの頻出「素数もどき」の分解。 |
| **Level 2** | パターン網羅 | 119, 133, 143, 221 などのより大きな数の分解。 |
| **Level 3** | 壁・瞬発力 | 素数判定（〇×形式）と、3・4の倍数判定の混在。 |
| **Level 4** | 応用・実践 | 約分への応用。GCD（最大公約数）を答える問題。 |
| **Level 5** | 達人・複合 | 難易度の高い約分や、計算の工夫（17×19=323）。 |

#### 【単元E】黄金ペア：25, 125, 625 (`sec1e`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 25×4, 125×8 の基本と、その簡単な倍数（25×8, ×12など）。 |
| **Level 2** | パターン網羅 | ÷4×100 や ÷8×1000 の技法を使う広範囲な計算。 |
| **Level 3** | 壁・瞬発力 | 逆算 (□×25=1200) や 625×16=10000 などの高次ペア。 |
| **Level 4** | 応用・実践 | 割り算への応用（3600÷25など）。 |
| **Level 5** | 達人・複合 | 黄金ペアの多項計算や、小数を含む複合問題。 |

#### 【単元F】補数：100, 1000, 1 (`sec1f`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 足して100になる数の発見。 |
| **Level 2** | パターン網羅 | 足して1000になる数（3桁の補数）の網羅。 |
| **Level 3** | 壁・瞬発力 | 引き算形式 (100-47) や、1に対する補数（1-0.375）。 |
| **Level 4** | 応用・実践 | 補数を使った足し算の工夫 (98+47 → 100+45)。 |
| **Level 5** | 達人・複合 | 補数の連鎖計算や、(100-a)+(100-b) などの複合。 |

#### 【単元G】瞬発暗算：1桁×2桁 (`sec1g`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 基本的な九九の復習（6〜9の段中心）。 |
| **Level 2** | パターン網羅 | 1桁×10番台 (6×15など) の分配法則での計算。 |
| **Level 3** | 壁・瞬発力 | 1桁×大きな2桁 (6×78など)。引き算の分配 (6×80-12) の活用。 |
| **Level 4** | 応用・実践 | 2桁×1桁 (13×6など) の順序入れ替えや、より実戦的な計算。 |
| **Level 5** | 達人・複合 | 12×13 などの2桁×2桁の基本や、3項の掛け算。 |

---

### 第2部：構造視力

#### 【単元A】分配法則：基本 (`sec2a`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | a×b + a×c = a×(b+c) で、(b+c)が100になるパターン。 |
| **Level 2** | パターン網羅 | (b+c)が100以外のキリの良い数になるパターン。 |
| **Level 3** | 壁・瞬発力 | 引き算の分配法則 a×b - a×c = a×(b-c) の導入。 |
| **Level 4** | 応用・実践 | 3項以上の分配法則。 |
| **Level 5** | 達人・複合 | 999×37 + 37 = 37×(999+1) のような「隠れた1」を見つける問題。 |

#### 【単元B】分配応用：100に近い数 (`sec2b`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 101×n = (100+1)×n の計算（101×24など）。 |
| **Level 2** | パターン網羅 | 99×n (100-1) や 102×n, 98×n などのバリエーション。 |
| **Level 3** | 壁・瞬発力 | 103, 97, 104, 96 など、100との差が1, 2以外のパターン。 |
| **Level 4** | 応用・実践 | 98×47 など、暗算の工夫を実践的に使う問題。 |
| **Level 5** | 達人・複合 | 99×98（両方100に近い）や 101×101 などの高度な計算。 |

#### 【単元C】結合・分解：黄金ペアの発見 (`sec2c`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 25×4, 125×8, 625×16 などの直接的な黄金ペア。 |
| **Level 2** | パターン網羅 | 25×8, 125×16 など、黄金ペアの倍数（一方を分解）。 |
| **Level 3** | 壁・瞬発力 | 32×25, 96×125 など、一方を完全に分解して黄金ペアを作る。 |
| **Level 4** | 応用・実践 | 8×37×125 のように、順序や組み合わせを変える計算。 |
| **Level 5** | 達人・複合 | 16×125×5×2 などの多項結合や、より大きな数。 |

#### 【単元D】小数分数：計算での活用 (`sec2d`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 0.5+1/4 などの足し算形式。小数か分数に統一する練習。 |
| **Level 2** | パターン網羅 | 0.75×8 などの掛け算形式。分数にすると整数になるパターン。 |
| **Level 3** | 壁・瞬発力 | 引き算や割り算（0.5÷0.125など）の混在。 |
| **Level 4** | 応用・実践 | 0.8×2.5 など、両方を分数にして約分する実践的な計算。 |
| **Level 5** | 達人・複合 | (0.5+1/4)×8 などの多項計算や、逆算を含む問題。 |

#### 【単元E】約分：計算を先に (`sec2e`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | a×b÷c で、a か b が c で割り切れる基本形。 |
| **Level 2** | パターン網羅 | cが複数の因数にまたがって約分される形（例: 24×15÷18）。 |
| **Level 3** | 壁・瞬発力 | 分数の掛け算形式での約分（2/3 × 9/4 など）。 |
| **Level 4** | 応用・実践 | 分子と分母に複数の項がある分数式の約分。 |
| **Level 5** | 達人・複合 | 3項以上の複雑な約分や、カッコを含む難しい計算。 |

#### 【単元F】数列：等差数列の和 (`sec2f`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 1〜5, 1〜10 などの小さな自然数の和。 |
| **Level 2** | パターン網羅 | 公式の適用 (n×(n+1)÷2)。1〜25, 1〜100 など。 |
| **Level 3** | 壁・瞬発力 | 偶数列 (2+4+…) や奇数列 (1+3+…) などの変則数列。 |
| **Level 4** | 応用・実践 | 途中から始まる数列 (5+6+…+15) や、等差数列 (7+14+…)。 |
| **Level 5** | 達人・複合 | 連続する奇数の和（個数×個数）の活用や、数列の差。 |

#### 【単元G】桁数・ゼロ処理 (`sec2g`)

| レベル | テーマ | 具体的な内容 |
| :--- | :--- | :--- |
| **Level 1** | 基本の反復 | 整数×10, 100, 1000。小数点を右に動かす。 |
| **Level 2** | パターン網羅 | 整数÷10, 100, 1000（小数点を左へ）と小数の10倍など。 |
| **Level 3** | 壁・瞬発力 | 25×40, 125×80 など、黄金ペアとゼロ処理の融合。 |
| **Level 4** | 応用・実践 | 2.5×0.4 など、小数どうしの積で桁数が変わる問題。 |
| **Level 5** | 達人・複合 | 99999÷11111 などのゾロ目処理や、複数のゼロ処理。 |

---

## テストファイルの設計

### ファイル命名規則

```
sec[ステージ番号]_survival.js
```

例: `sec1_survival.js`

### データ構造

```javascript
addData({
  id: "sec1_survival",
  chapter: "第1部：反射神経",
  section: "サバイバルテスト",
  title: "反射神経【連続正解チャレンジ 35】",
  method: "ルール：制限時間3分。番号順に解くこと！1番から連続正解したところまでが得点",
  patternLabels: ["セットA", "セットB", "セットC"],  // 重要：セット名の指定
  patterns: [
    {
      problems: [
        // Q1-7: Level 1（各単元から1問ずつ）
        // Q8-14: Level 2（各単元から1問ずつ）
        // Q15-21: Level 3（各単元から1問ずつ）
        // Q22-28: Level 4（各単元から1問ずつ）
        // Q29-35: Level 5（各単元から1問ずつ）
      ],
      answers: [...],
      annotations: [...]
    },
    // セットB, セットC...
  ]
});
```

### 問題選定原則

#### 基本ルール

1. **各レベルから各単元1問ずつ選ぶ**（7単元 × 5レベル = 35問）
2. **難易度順に並べる**（Q1が最も簡単、Q35が最も難しい）
3. **単元の順序を統一**（A→B→C→D→E→F→G）

#### 避けるべきパターン

❌ **逆問題の配置**

- 例: Q1が「0.5→分数」、Q8が「1/2→小数」
- 理由: 逆の問題だと答えが簡単にわかってしまう
- 対策: 別の数値を使う（Q1を0.75にするなど）

❌ **同じ答えの問題**

- 例: Q5が「25×4=100」、Q6が「32+68=100」
- 理由: 同じ答えだと記憶に頼れてしまう
- 対策: 一方を別の数値に変更

❌ **○×判定の偏り**

- 例: 素数判定が両方○、倍数判定が両方×
- 理由: パターンが読めてしまう
- 対策: ○と×を混在させる

❌ **難易度順の乱れ**

- 例: Level 4の問題がLevel 3より簡単
- 理由: 連続正解の採点方式に矛盾
- 対策: 各レベル内でも適切な難易度の問題を選ぶ

### セット間の多様性

- **セットA, B, C**: 異なる数値・異なる問題を使う
- **目的**: 同じ生徒が複数セットに挑戦できるようにする
- **例**:
  - セットA: 51の素因数分解
  - セットB: 59は素数か？
  - セットC: 67は素数か？

---

## ファイル一覧

### 第1部：反射神経（7単元）

#### 訓練ファイル

| ファイル名 | 日本語名 | 内容 |
|-----------|---------|------|
| `sec1a_decimal_fraction.js` | 小数↔分数変換 | 0.5, 0.25, 0.125などの基本的な小数と分数の相互変換 |
| `sec1b_squares.js` | 平方数：11～19の段 | 11×11～19×19の平方数の暗記 |
| `sec1c_pi.js` | 円周率の段：3.14の暗算 | 3.14×2, 3.14×3などの暗記 |
| `sec1d_primes.js` | 素数判定 | 51, 57, 91などの素因数分解と素数判定 |
| `sec1e_golden_pairs.js` | 黄金ペア | 25×4=100, 125×8=1000の活用 |
| `sec1f_complements.js` | 補数 | 足して100, 1000になる数の組み合わせ |
| `sec1g_mental_math.js` | 瞬発暗算 | 九九と1桁×2桁の分配法則 |

#### テストファイル

| ファイル名 | 日本語名 | 内容 |
|-----------|---------|------|
| `sec1_survival.js` | 反射神経サバイバルテスト | 35問・3セット（A, B, C） |

### 第2部：構造視力（7単元）

#### 訓練ファイル

| ファイル名 | 日本語名 | 内容 |
|-----------|---------|------|
| `sec2a_distribution_basic.js` | 分配法則：基本 | 34×13+34×87のような共通因数を見つける計算 |
| `sec2b_distribution_advanced.js` | 分配法則：100に近い数 | 101×24=(100+1)×24のような計算 |
| `sec2c_associative.js` | 結合分解 | 25×8=25×4×2=100×2のような計算 |
| `sec2d_decimal_fraction_calc.js` | 小数分数：計算での変換活用 | 0.75×8→3/4×8のような変換を使った計算 |
| `sec2e_reduction.js` | 約分 | 18×5÷6のように先に約分してから計算 |
| `sec2f_sequence.js` | 数列：等差数列の和 | 1+2+3+...+nの公式と応用 |
| `sec2g_digits_zero.js` | 桁数・ゼロ処理 | 10, 100, 1000の掛け算・割り算 |

#### テストファイル

| ファイル名 | 日本語名 | 内容 |
|-----------|---------|------|
| `sec2_survival.js` | 構造視力サバイバルテスト | 35問・3セット（A, B, C） |

### 第3部：持久力（未実装）

---

## 問題作成の原則

### 🔑 重要な設計原則

> **「暗記すべき『知識』はかぶらせる（同じにする）」**
>
> **「解き方の『手順・構造』を問う問題は、数値を変えてかぶらせない」**

### 暗記項目（同じ問題でOK）

以下の単元では、**Level 1で同じ問題を繰り返してOK**：

| 単元 | 暗記内容 | 例 |
|------|---------|-----|
| 小数↔分数 | 基本的な変換 | 0.5=1/2, 0.25=1/4, 0.125=1/8 |
| 平方数 | 11×11～19×19 | 11×11=121, 12×12=144, 13×13=169 |
| 円周率 | 3.14の段 | 3.14×2=6.28, 3.14×3=9.42 |
| 黄金ペア | 特定の組み合わせ | 25×4=100, 125×8=1000 |
| 補数 | 足して100/1000 | 32+68=100, 375+625=1000 |
| 瞬発暗算 | 九九 | 7×8=56, 9×6=54 |

**理由**: 反復によって自動化（オートマティシティ）を実現する

### 構造項目（数値を変える）

以下の単元では、**Level 1でも異なる数値を使う**：

| 単元 | 構造の種類 | 例 |
|------|-----------|-----|
| 素数判定 | 素因数分解の手順 | 51, 57, 91, 77（全て異なる数） |
| 分配法則 | 共通因数の発見 | 34×13+34×87, 27×15+27×85 |
| 100に近い数 | (100±1)×nの展開 | 101×12, 101×24, 101×36 |
| 結合分解 | 因数の分解と再結合 | 25×4, 4×25, 125×8, 8×125 |
| 小数分数計算 | 変換の判断 | 0.5+1/4, 1/2+0.25, 0.25+1/2 |
| 約分 | 共通因数の発見 | 18×5÷6, 12×7÷4, 15×8÷5 |
| 数列 | 公式の適用 | 1+...+10, 1+...+11, 1+...+12 |
| 桁数・ゼロ | 小数点の移動 | 25×10, 34×10, 56×10 |

**理由**: 転移学習（Transfer Learning）を促進し、手順の理解を深める

### エピソード記憶 vs 意味記憶

- **エピソード記憶**（避けるべき）: 「この問題はこの答え」という一対一の暗記
  - 例: 「51を見たら3×17と答える」（理解なし）

- **意味記憶**（目指すべき）: 手順・構造の理解に基づく記憶
  - 例: 「51 → 各桁の和=6 → 3の倍数 → 51÷3=17 → 3×17」（理解あり）

構造項目で数値を変えることで、エピソード記憶を防ぎ、意味記憶（構造の理解）を促す。

---

## 変更履歴

### 2026-02-10

- 初版作成
- 訓練ファイルとテストファイルの設計を統合
- 問題作成の原則を明文化
- ファイル一覧を整理

### 2026-02-10 (v1.1)

- 小学生向けにルート ($\sqrt{}$)・累乗 ($x^n$) 表記を廃止
- 単元B（平方数）を2レベル構成（基本・小数混じり）に変更
- サバイバルテストの選定ルールを単元Bの変更に合わせて調整

---

## 📝 使い方

1. **新しい単元を作成する前に**: この設計書を読み、構造を理解する
2. **設計を変更する場合**: まずこのDESIGN.mdを更新してから、実際のファイルを変更する
3. **問題を作成する場合**: 「問題作成の原則」を確認し、暗記項目か構造項目かを判断する
4. **テストを作成する場合**: 「避けるべきパターン」をチェックリストとして使う

---

**最終更新**: 2026-02-10
**バージョン**: 1.1
